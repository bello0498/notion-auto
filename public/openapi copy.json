{
  "$schema": "https://spec.openapis.org/oas/3.1/dialect/base",
  "openapi": "3.1.0",
  "info": {
    "title": "Notion + Confluence Auto Save API",
    "version": "1.4.0",
    "description": "Create a Notion database item/page and also create Confluence pages."
  },
  "servers": [
    {
      "url": "https://notion-auto.vercel.app",
      "description": "Production"
    }
  ],
  "paths": {
    "/api/save": {
      "post": {
        "operationId": "saveToNotion",
        "summary": "Save content into Notion (DB, Page, or Both)",
        "description": "Save text into Notion Database, Page, or both depending on mode.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["mode"],
                "additionalProperties": false,
                "properties": {
                  "mode": {
                    "type": "string",
                    "enum": ["db", "page", "both"],
                    "description": "ì €ì¥ ëª¨ë“œ ì„ íƒ (db: DBì— ì €ì¥, page: Pageì— ì €ì¥, both: ë‘˜ ë‹¤ ì €ì¥)"
                  },
                  "title": {
                    "type": "string",
                    "description": "ì œëª© (ì—†ìœ¼ë©´ content ì²« ì¤„ ë˜ëŠ” ìë™ ìƒì„±)"
                  },
                  "content": {
                    "type": "string",
                    "description": "ë³¸ë¬¸ (Markdown ì¼ë¶€ ì§€ì›: #, ##, ###, - )"
                  },
                  "url": {
                    "type": "string",
                    "format": "uri",
                    "description": "(DB ëª¨ë“œ ì „ìš©) URL ì†ì„± ê°’"
                  },
                  "date": {
                    "type": "string",
                    "description": "(DB ëª¨ë“œ ì „ìš©) ë‚ ì§œ (YYYY-MM-DD ë˜ëŠ” ISO datetime)"
                  },
                  "tags": {
                    "type": "array",
                    "items": { "type": "string" },
                    "description": "(DB ëª¨ë“œ ì „ìš©) íƒœê·¸ ëª©ë¡ (multi_select)"
                  },
                  "status": {
                    "type": "string",
                    "description": "(DB ëª¨ë“œ ì „ìš©) ìƒíƒœ ê°’ (Select ê¶Œì¥)"
                  },
                  "pageId": {
                    "type": "string",
                    "description": "(Page ëª¨ë“œ ì „ìš©, ì„ íƒ) ìƒìœ„ Page ID. ì—†ìœ¼ë©´ env NOTION_PAGE_ID ì‚¬ìš©"
                  },
                  "databaseId": {
                    "type": "string",
                    "description": "(DB ëª¨ë“œ ì „ìš©, ì„ íƒ) DB ID override. ì—†ìœ¼ë©´ env NOTION_DATABASE_ID ì‚¬ìš©"
                  }
                },
                "example": {
                  "mode": "both",
                  "title": "Both Save Test",
                  "content": "### One shot\\n- DB + child page",
                  "status": "In progress"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "ì„±ê³µì ìœ¼ë¡œ ì €ì¥ë¨",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": ["ok", "mode", "results"],
                  "properties": {
                    "ok": { "type": "boolean" },
                    "mode": { "type": "string", "enum": ["db", "page", "both"] },
                    "results": {
                      "type": "object",
                      "properties": {
                        "db": { "type": "string", "description": "DBì— ìƒì„±ëœ pageId" },
                        "page": { "type": "string", "description": "Pageì— ìƒì„±ëœ pageId" },
                        "url": { "type": "string", "format": "uri", "description": "ìƒì„±ëœ ë…¸ì…˜ í˜ì´ì§€/ì•„ì´í…œ ì›¹ URL" },
                        "title": { "type": "string", "description": "ì €ì¥ëœ ì œëª©" },
                        "contentPreview": { "type": "string", "description": "ë³¸ë¬¸ ì•ë¶€ë¶„ ë¯¸ë¦¬ë³´ê¸°" },
                        "tags": {
                          "type": "array",
                          "items": { "type": "string" },
                          "description": "ì €ì¥ëœ íƒœê·¸"
                        },
                        "status": { "type": "string", "description": "ì €ì¥ëœ ìƒíƒœ" },
                        "savedAt": { "type": "string", "format": "date-time", "description": "ì €ì¥ ì‹œê°" }
                      },
                      "additionalProperties": false
                    }
                  },
                  "additionalProperties": false
                },
                "examples": {
                  "dbSuccess": {
                    "summary": "DB only success",
                    "value": {
                      "ok": true,
                      "mode": "db",
                      "results": {
                        "db": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
                        "url": "https://www.notion.so/xxxxxxxxxxxx",
                        "title": "DB Save Test",
                        "contentPreview": "ë³¸ë¬¸ ì¼ë¶€ ë¯¸ë¦¬ë³´ê¸°...",
                        "tags": ["í¼ë¸”ë¦¬ì‹±"],
                        "status": "In progress",
                        "savedAt": "2025-09-02T12:30:00Z"
                      }
                    }
                  },
                  "pageSuccess": {
                    "summary": "Page only success",
                    "value": {
                      "ok": true,
                      "mode": "page",
                      "results": {
                        "page": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
                        "url": "https://www.notion.so/xxxxxxxxxxxx",
                        "title": "Page Save Test",
                        "contentPreview": "ë³¸ë¬¸ ì¼ë¶€ ë¯¸ë¦¬ë³´ê¸°...",
                        "tags": [],
                        "status": "ì™„ë£Œ",
                        "savedAt": "2025-09-02T12:31:00Z"
                      }
                    }
                  },
                  "bothSuccess": {
                    "summary": "Both success",
                    "value": {
                      "ok": true,
                      "mode": "both",
                      "results": {
                        "db": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
                        "page": "xxxxxxxx-xxxx-xxxx-xxxx-xxxxxxxxxxxx",
                        "url": "https://www.notion.so/xxxxxxxxxxxx",
                        "title": "Both Save Test",
                        "contentPreview": "ë³¸ë¬¸ ì¼ë¶€ ë¯¸ë¦¬ë³´ê¸°...",
                        "tags": ["í¼ë¸”ë¦¬ì‹±", "DevOps"],
                        "status": "In progress",
                        "savedAt": "2025-09-02T12:32:00Z"
                      }
                    }
                  }
                }
              }
            }
          },
          "400": { "description": "ì˜ëª»ëœ ìš”ì²­ (ì˜ˆ: mode ëˆ„ë½, íƒ€ì… ë¶ˆì¼ì¹˜)" },
          "500": { "description": "ì„œë²„ ì˜¤ë¥˜ ë˜ëŠ” Notion API ì˜¤ë¥˜" }
        }
      }
    },
    "/api/gptConfluence": {
      "post": {
        "operationId": "saveToConfluence",
        "summary": "Save content into Confluence",
        "description": "Create a page in Confluence under the specified spaceKey.",
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["title", "content", "spaceKey"],
                "properties": {
                  "title": { "type": "string", "description": "í˜ì´ì§€ ì œëª©" },
                  "content": { "type": "string", "description": "ë³¸ë¬¸ (HTML í¬ë§· ê¶Œì¥, storage representation)" },
                  "spaceKey": { "type": "string", "description": "ëŒ€ìƒ Confluence Space Key" },
                  "tags": { "type": "array", "items": { "type": "string" }, "description": "ë¬¸ì„œ íƒœê·¸ (Confluence Label)" },
                  "date": { "type": "string", "format": "date", "description": "ë¬¸ì„œ ìƒì„±ì¼ (YYYY-MM-DD)" },
                  "status": { "type": "string", "description": "ë¬¸ì„œ ìƒíƒœ (ì˜ˆ: ì´ˆì•ˆ, ì‘ì„±ì¤‘, ì™„ë£Œ)" }
                },
                "example": {
                  "title": "Confluence Test Page",
                  "content": "<p>í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ğŸš€</p>",
                  "spaceKey": "~63913894213a315af34b9608",
                  "tags": ["í¼ë¸”ë¦¬ì‹±", "DevOps"],
                  "date": "2025-09-02",
                  "status": "ì´ˆì•ˆ"
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "Page created successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "required": ["ok", "id", "links"],
                  "properties": {
                    "ok": { "type": "boolean", "example": true },
                    "id": { "type": "string", "description": "ìƒì„±ëœ Confluence pageId" },
                    "links": {
                      "type": "object",
                      "properties": {
                        "webui": { "type": "string", "description": "ì›¹ì—ì„œ ì ‘ê·¼ ê°€ëŠ¥í•œ í˜ì´ì§€ URL" }
                      }
                    },
                    "title": { "type": "string", "description": "ì €ì¥ëœ ì œëª©" },
                    "contentPreview": { "type": "string", "description": "ë³¸ë¬¸ ì¼ë¶€ (ì•ë¶€ë¶„ ë¯¸ë¦¬ë³´ê¸°)" },
                    "tags": { "type": "array", "items": { "type": "string" } },
                    "status": { "type": "string" },
                    "savedAt": { "type": "string", "format": "date-time", "description": "ì €ì¥ëœ ì‹œê°" }
                  }
                },
                "examples": {
                  "confluenceSuccess": {
                    "summary": "Confluence ì €ì¥ ì„±ê³µ",
                    "value": {
                      "ok": true,
                      "id": "123456",
                      "links": {
                        "webui": "/spaces/~63913894213a315af34b9608/pages/123456"
                      },
                      "title": "Confluence Test Page",
                      "contentPreview": "<p>í…ŒìŠ¤íŠ¸ í˜ì´ì§€ ğŸš€</p>",
                      "tags": ["í¼ë¸”ë¦¬ì‹±", "DevOps"],
                      "status": "ì´ˆì•ˆ",
                      "savedAt": "2025-09-02T12:40:00Z"
                    }
                  }
                }
              }
            }
          },
          "400": { "description": "ì˜ëª»ëœ ìš”ì²­ (ì˜ˆ: spaceKey ëˆ„ë½)" },
          "500": { "description": "Confluence API ì˜¤ë¥˜" }
        }
      }
    }
  }
}
